/* 
 * "Small Hello World" example. 
 * 
 * This example prints 'Hello from Nios II' to the STDOUT stream. It runs on
 * the Nios II 'standard', 'full_featured', 'fast', and 'low_cost' example 
 * designs. It requires a STDOUT  device in your system's hardware. 
 *
 * The purpose of this example is to demonstrate the smallest possible Hello 
 * World application, using the Nios II HAL library.  The memory footprint
 * of this hosted application is ~332 bytes by default using the standard 
 * reference design.  For a more fully featured Hello World application
 * example, see the example titled "Hello World".
 *
 * The memory footprint of this example has been reduced by making the
 * following changes to the normal "Hello World" example.
 * Check in the Nios II Software Developers Manual for a more complete 
 * description.
 * 
 * In the SW Application project (small_hello_world):
 *
 *  - In the C/C++ Build page
 * 
 *    - Set the Optimization Level to -Os
 * 
 * In System Library project (small_hello_world_syslib):
 *  - In the C/C++ Build page
 * 
 *    - Set the Optimization Level to -Os
 * 
 *    - Define the preprocessor option ALT_NO_INSTRUCTION_EMULATION 
 *      This removes software exception handling, which means that you cannot 
 *      run code compiled for Nios II cpu with a hardware multiplier on a core 
 *      without a the multiply unit. Check the Nios II Software Developers 
 *      Manual for more details.
 *
 *  - In the System Library page:
 *    - Set Periodic system timer and Timestamp timer to none
 *      This prevents the automatic inclusion of the timer driver.
 *
 *    - Set Max file descriptors to 4
 *      This reduces the size of the file handle pool.
 *
 *    - Check Main function does not exit
 *    - Uncheck Clean exit (flush buffers)
 *      This removes the unneeded call to exit when main returns, since it
 *      won't.
 *
 *    - Check Don't use C++
 *      This builds without the C++ support code.
 *
 *    - Check Small C library
 *      This uses a reduced functionality C library, which lacks  
 *      support for buffering, file IO, floating point and getch(), etc. 
 *      Check the Nios II Software Developers Manual for a complete list.
 *
 *    - Check Reduced device drivers
 *      This uses reduced functionality drivers if they're available. For the
 *      standard design this means you get polled UART and JTAG UART drivers,
 *      no support for the LCD driver and you lose the ability to program 
 *      CFI compliant flash devices.
 *
 *    - Check Access device drivers directly
 *      This bypasses the device file system to access device drivers directly.
 *      This eliminates the space required for the device file system services.
 *      It also provides a HAL version of libc services that access the drivers
 *      directly, further reducing space. Only a limited number of libc
 *      functions are available in this configuration.
 *
 *    - Use ALT versions of stdio routines:
 *
 *           Function                  Description
 *        ===============  =====================================
 *        alt_printf       Only supports %s, %x, and %c ( < 1 Kbyte)
 *        alt_putstr       Smaller overhead than puts with direct drivers
 *                         Note this function doesn't add a newline.
 *        alt_putchar      Smaller overhead than putchar with direct drivers
 *        alt_getchar      Smaller overhead than getchar with direct drivers
 *
 */

#include "sys/alt_stdio.h"

#include "drivers/drivers.c"

#define BUFFER_RECEIVER_LEN 128
#define MAX_RECEIVED_MESSAGE_LEN 2048
#define MAX_RECEIVE_TIME_OUT 120


char buffer[128];

char signal[] = {0,39,75,103,121,127,121,75,39,-39,-75,-103,-121,-127,-121,-103,-75,-39};
char in[] = {-28,-16,70,-19,32,-18,-25,24,-39,15,-13,18,15,-6,15,24,23,-3,15,-15,2,-10,-5,-46,5,-23,0,15,2,6,56,2,-4,-41,1,-6,-16,27,-11,15,32,30,-2,8,26,-60,-56,-13,-65,-22,45,-24,-10,20,10,-1,8,-26,-6,1,43,-62,2,-21,28,37,-33,7,1,-18,-41,15,-16,17,37,-21,30,-3,-26,-17,16,42,20,-20,4,33,31,-7,-33,1,-9,6,7,-45,-18,-25,32,3,-17,-23,2,0,17,29,42,43,-26,-15,37,3,-33,-17,-8,5,-12,-24,-33,3,-28,2,3,-4,-50,-25,42,-7,-26,-9,-29,16,35,17,-2,-36,7,1,15,16,-4,56,-22,46,-19,40,4,-10,-2,30,-2,-14,28,12,-22,23,42,21,-4,-9,20,-10,16,18,-8,42,-13,-37,11,14,26,29,3,31,-22,-30,8,1,33,39,-9,9,-34,-29,-21,22,-44,24,-15,54,-21,-3,24,-13,-18,-30,1,-19,-24,-22,2,9,-43,-12,13,-25,20,-60,12,9,-58,10,6,-17,-23,-37,-58,29,33,-32,-38,-20,4,-23,2,46,41,9,-15,-30,34,-3,36,11,3,-3,-8,-15,3,8,-48,17,4,97,-24,18,45,-26,-67,5,11,-13,17,-25,11,0,-5,-19,-53,23,8,-21,-1,-40,12,-32,-42,-66,-20,-23,3,59,28,-15,9,35,-26,-51,6,-46,3,15,-8,-26,-33,14,-31,-32,12,-39,-19,-9,33,-38,-19,24,-1,24,-21,7,57,16,23,2,-20,-22,9,-16,-7,-24,7,22,-21,11,35,-27,-21,4,15,-4,-26,-22,43,-2,1,15,4,-43,-6,-15,8,-1,-22,15,13,-26,20,36,-20,20,-65,-15,-21,47,14,1,-8,-3,-7,-17,43,5,34,6,-2,-12,12,36,19,40,51,26,-26,-16,-16,-10,29,8,-11,-17,-9,39,7,2,15,59,31,20,22,-4,-15,-8,10,-8,-52,17,53,0,16,8,15,-34,13,-14,-3,-25,15,-31,9,-11,14,17,-26,25,-29,-11,23,-46,37,2,28,-1,-45,18,32,-32,-18,14,21,26,-35,2,-7,-12,-20,-34,12,25,11,16,-28,-29,18,2,73,5,8,14,-27,-12,24,-13,-33,-24,-26,67,-42,1,23,20,36,-5,39,-5,27,-19,16,-12,-1,-51,51,-46,22,-23,-20,-8,2,14,-35,22,-8,-19,30,28,-13,8,20,19,8,10,15,-9,18,-2,12,28,-28,-29,-12,71,-18,12,27,42,10,-1,-5,-62,31,-36,8,16,41,30,-14,-8,-78,-16,34,-30,2,-30,-26,-35,1,31,24,-7,12,17,-8,7,-17,-5,-9,-23,-20,26,12,-22,-13,28,-13,56,-35,2,5,-27,-15,-34,-13,74,21,-6,18,20,-8,10,-25,-15,-28,-28,-36,-11,-33,5,-51,32,11,-36,22,11,17,-18,-9,1,-31,0,49,11,-49,-17,1,-31,-23,-26,-53,13,30,-10,2,-11,33,-40,-23,-1,61,-7,16,39,0,-31,16,-41,-12,-17,6,38,14,-31,7,23,1,16,5,1,29,19,-50,-23,14,-69,-5,1,10,2,11,18,-4,28,7,-10,-36,24,25,54,39,-17,11,-40,-5,-20,-38,-2,-35,26,-34,19,2,-28,21,-4,5,-16,15,-16,12,-18,51,30,-13,-6,-4,-20,-34,17,5,-11,-7,-21,21,23,-16,-32,19,-38,3,25,14,-38,-10,-16,-20,31,-15,34,16,53,8,9,-22,-27,-19,47,9,6,-11,34,-37,4,-54,-7,-36,23,-14,0,-3,-36,-46,11,5,-23,-16,-11,20,46,43,-15,48,-9,-29,1,-15,-39,-15,10,4,-14,61,52,16,-40,6,3,0,6,-14,-7,-24,-24,-43,28,-42,20,26,11,2,-27,-67,4,13,-30,-58,-11,-14,-12,30,-13,26,5,-19,-28,-20,28,-25,-25,-33,-3,-10,-27,22,-21,-5,30,26,4,-19,-14,-15,-6,24,12,3,-13,-1,19,3,-13,13,-40,-24,0,-18,-50,-16,29,19,14,17,-7,20,15,-21,-2,5,44,-11,-5,-24,46,33,-13,13,39,13,-8,44,-34,38,-10,12,14,48,-44,8,-17,-12,-15,-45,-15,-31,-28,-8,-13,4,1,35,4,-36,13,-6,-43,1,10,-9,-29,16,13,4,4,27,7,-19,76,11,5,12,26,8,26,63,-23,33,8,-7,23,-12,26,-1,6,-74,0,-3,-19,-38,-3,44,11,-2,-25,39,21,27,-13,33,26,-10,2,-6,-2,31,-7,-1,-1,1,-21,2,2,-29,16,11,36,-27,-2,-43,16,-57,13,26,-16,29,-19,31,0,44,-38,31,-20,-1,8,-9,24,23,2,-2,32,42,-4,-41,2,-3,37,-9,-18,-20,-21,18,-41,-21,-12,5,31,75,-1,-25,-7,-13,-9,0,10,-36,-19,-24,26,23,10,-28,3,-5,15,-35,-21,19,-11,-14,2,5,46,-37,-21,-47,30,-35,51,-18,45,-21,-33,-8,-34,-5,1,6,-3,-16,-3,8,16,-17,-9,-8,-44,-29,7,33,2,33,-32,3,11,16,26,17,11,18,-19,-32,-14,23,15,-42,0,-20,-17,10,-18,-24,7,36,-31,5,15,25,-22,-29,17,73,1,-3,-5,43,-47,32,-15,33,2,-43,11,7,15,-10,-17,11,24,-1,-6,-29,-25,10,3,30,-22,-23,18,-19,-15,36,-20,5,-8,60,-14,1,-9,9,-22,25,-2,18,-25,19,-26,20,7,-30,-19,39,-4,9,28,17,-22,13,-32,-35,-18,-26,5,-18,6,-13,-18,-46,0,34,-10,2,-2,32,-18,4,-21,18,-52,4,54,-2,53,-7,-8,20,37,-14,-33,30,40,13,24,-29,22,-6,-52,-25,17,-39,-2,-8,-12,21,-5,-1,41,-4,22,-32,11,-30,-30,-8,10,-24,7,-16,16,8,-4,-7,-8,33,-17,-24,-21,-37,19,15,30,-23,-3,-8,-12,-22,11,-9,-13,-38,-10,25,32,-1,36,-8,4,24,-23,9,44,-59,19,26,15,36,24,-22,47,22,-37,-2,32,-6,4,-18,-9,7,-25,-52,25,-22,1,-9,-16,-5,-16,8,-6,-11,-2,17,-23,-12,21,34,-23,3,-30,-37,-28,-49,-8,-47,-4,-14,18,14,-5,51,-24,18,-15,11,-12,-26,-30,2,36,-7,-58,-6,1,-35,18,14,31,10,10,20,45,-3,31,15,-11,24,16,-15,-11,0,-4,14,23,-12,-57,-31,85,-3,-16,11,14,20,9,-24,-20,32,5,0,20,21,-49,4,-16,29,-15,-16,-45,-60,4,-4,24,7,7,-36,-26,22,-18,-17,-5,-4,65,15,-46,-51,-30,1,16,10,-2,-10,40,2,-25,-79,19,-1,21,17,-49,-8,1,25,3,-2,-32,-1,-45,-16,-37,33,-1,-15,16,45,11,33,-26,-20,19,49,-27,-16,-8,24,-7,66,-2,21,21,-4,-17,4,10,-36,-23,11,-13,-24,-11,1,46,-10,3,19,9,12,-8,-79,-9,2,10,26,30,-1,1,36,-25,43,14,-2,-14,-17,-23,19,-53,-17,20,-16,-7,16,0,-5,32,-63,11,-15,-21,-14,-7,-20,-4,9,-9,-12,-8,12,41,-3,44,38,-5,-7,-23,23,27,-40,23,-7,-27,14,-10,-8,-21,34,35,-5,13,12,-27,-9,4,-22,48,-7,-29,22,-4,-28,29,-27,25,-4,-13,2,2,7,-18,-26,2,34,-27,-18,13,-47,0,-39,-25,12,4,41,6,-13,-18,-15,28,46,26,-4,16,9,36,-5,-17,36,-25,51,-37,41,2,28,-11,-42,-40,25,20,-52,-8,9,43,28,-28,11,5,2,-21,6,-6,25,17,18,10,1,40,6,1,-16,7,19,-43,33,7,-32,32,7,20,-4,-9,-10,27,7,-34,14,-28,24,7,-25,-13,-36,18,21,15,33,33,10,-34,-2,3,0,-34,-21,-3,32,20,26,-8,-11,26,1,-19,-14,-14,33,13,0,3,7,31,11,-27,-25,13,8,-6,-44,36,-18,45,3,-13,-20,-26,-38,-42,17,-8,13,-25,10,-4,5,62,19,-22,-10,-7,-29,-19,-20,-11,1,12,-25,14,6,16,29,-27,55,-40,25,-38,27,9,55,-10,-47,4,-12,12,-14,-16,-25,-12,-26,19,-4,-8,-20,32,27,17,-11,25,-35,21,-25,1,-17,-33,16,-45,-9,-2,56,0,14,-15,-34,3,-25,-2,-13,15,13,36,-15,36,-3,-4,22,-30,23,-49,-40,-12,12,12,-7,9,10,-18,2,12,41,-25,9,10,28,28,14,-20,6,-6,-54,-60,19,12,-41,-65,-24,-40,21,12,-26,-12,6,-48,56,38,9,-46,25,-5,-11,12,-15,32,-34,-12,-32,48,2,49,-15,-13,-45,-43,-14,3,4,-29,-25,29,5,59,37,-48,9,-26,-58,-3,-6,-4,23,-3,4,-16,1,0,-15,5,5,9,-28,17,-9,12,-24,-11,-41,-12,33,-59,-1,-12,-8,43,-9,-33,-10,7,10,30,-3,50,-26,4,5,-6,18,-58,-8,-22,-12,-19,-31,-19,5,-10,-39,8,-1,15,-23,-2,-2,-16,28,-12,23,1,5,-45,-25,2,26,6,6,27,2,62,-13,-20,4,43,-19,-11,45,34,44,-36,9,-31,-27,-21,-9,-17,-37,5,-3,2,28,-9,-69,2,18,36,12,-10,58,-5,14,-19,7,-4,9,-46,21,-12,4,14,10,9,-9,-32,-21,-2,11,-9,-16,3,22,23,-14,15,-27,-18,26,-59,-28,33,9,-27,-11,-9,31,-2,53,35,-44,41,6,8,40,2,38,27,5,-23,-3,-37,11,4,-25,0,39,26,-38,-8,11,12,-32,11,14,1,43,-10,-1,2,24,-20,23,-10,12,-20,10,23,-34,-18,-9,-10,-27,2,-5,34,-2,45,-29,-61,-8,25,-10,-1,-21,-9,-22,-3,-20,-20,16,-16,28,15,31,-35,-16,2,-57,-1,-16,-27,0,-10,37,4,5,-14,-7,-14,-23,-10,14,-34,7,-19,52,11,6,27,-9,-57,-27,25,21,0,-4,-28,-11,-34,-21,17,-20,10,-13,-5,22,9,39,-28,7,5,-17,-31,-52,55,-20,16,17,-5,18,4,-13,21,22,-27,-69,-2,-4,19,-10,0,6,-22,25,33,15,53,-7,-15,40,18,-31,-46,-9,14,-30,-22,8,-37,4,-13,-10,-42,12,41,11,13,23,6,-70,13,32,13,-46,5,-18,17,-8,10,-6,4,-11,62,16,-30,9,16,-14,-10,-2,12,12,-70,-15,-27,-14,-21,-2,32,-18,-33,15,-16,3,-54,63,-11,50,-21,-27,20,-17,14,15,-49,57,-20,-6,-5,23,-36,3,17,7,30,-4,-13,34,-2,-2,-42,26,-54,17,-46,-9,-50,25,13,-24,-57,1,-12,-55,-28,17,1,-23,51,11,0,6,3,15,-10,-33,-51,6,-1,9,-9,-1,-19,12,42,21,26,52,-3,-6,4,3,-11,-11,-11,-28,5,-27,0,53,19,-14,-36,2,-11,-37,29,-3,-13,-17,8,22,27,-18,-14,27,-17,45,26,-27,12,6,-12,31,29,15,-9,-4,4,-10,8,65,10,-26,-9,13,24,5,18,-1,19,-9,-12,30,19,-8,-30,-19,-27,32,-38,19,-43,-4,47,36,-18,17,-28,16,-49,-25,-17,6,-29,-2,-14,19,-20,18,-34,-17,9,23,18,-3,24,7,-41,-33,1,2,-30,0,11,-29,33,-6,32,-46,8,-36,20,31,-24,-15,-27,-8,-39,-7,4,-9,9,9,-43,30,-6,-27,-23,6,-13,-6,-19,-39,22,-12,37,-9,29,30,20,28,17,37,-12,7,45,25,-57,-32,-8,-22,38,40,-55,-59,9,-12,13,17,15,1,-12,-19,-47,-31,8,37,37,28,-16,-36,-50,61,-20,58,51,3,-37,-45,5,-34,-39,33,-13,32,-8,20,-14,-3,47,-3,-1,28,1,54,-10,31,15,-58,11,15,15,-16,-39,9,5,24,16,14,2,-7,-33,-47,-8,4,-7,-19,13,9,62,-9,29,-42,2,0,32,-6,10,-3,-20,-6,28,-39,7,-6,8,5,0,-24,-3,-21,3,-25,19,-31,23,-26,30,-6,-22,14,-5,5,-37,-8,28,-26,-84,-37,50,-57,16,27,13,37,-30,31,-8,30,-11,35,-60,38,12,31,-34,-7,-55,-20,-45,-25,-27,-20,-8,-37,2,-2,-20,-5,38,-3,14,-19,33,-14,8,-25,5,-28,13,2,16,8,32,-3,-25,-38,-35,-17,0,8,-37,38,-48,14,8,-18,-51,9,57,15,19,-16,-22,5,-7,33,27,11,13,-9,-26,38,-31,10,-8,0,-6,-28,18,9,10,-39,7,-32,-22,15,8,26,38,-12,14,46,-35,-30,6,31,29,-2,16,-22,26,17,-9,28,13,40,27,-15,42,-43,-53,18,-12,-40,22,31,-15,4,35,8,-51,23,18,-44,9,23,10,-3,37,40,6,20,-4,9,-21,9,-45,-19,-6,-9,49,-36,-29,-9,-14,0,-33,18,-24,-1,-24,0,30,-17,-27,-11,-8,-62,5,-20,20,31,-1,-4,-21,-4,9,-16,-6,-11,-4,0,-16,-19,-3,15,-15,-6,16,-25,-16,-13,-40,-8,30,-35,-22,-13,-49,-13,15,46,24,10,24,-24,-20,-11,-29,-3,-44,6,3,28,-10,27,0,8,37,65,46,0,18,5,1,-54,-7,39,10,-22,-11,20,-18,-37,-9,-29,0,68,18,-12,3,-32,3,3,38,-41,-23,11,7,15,-43,52,5,-20,2,16,9,-3,-35,-26,5,12,10,22,6,9,-21,3,3,36,33,29,11,-7,-7,2,17,-2,-15,29,-5,-10,-29,-8,-13,-28,21,29,-44,-11,9,3,-49,-31,18,1,-6,3,19,9,16,8,-2,20,12,26,5,-9,-45,-12,-19,-23,2,-10,19,-34,-9,-9,-36,-65,9,54,68,-1,-56,-16,12,15,14,-13,25,-37,2,-30,-18,-1,20,0,-20,-23,51,38,55,-39,-7,-29,4,28,24,68,-13,3,31,23,1,-15,-3,-5,5,-26,37,7,-16,16,14,27,2,13,-31,-15,-6,12,43,-24,14,22,4,-6,-7,50,1,39,31,34,23,18,-15,38,3,14,-35,18,-10,-39,-20,-9,1,45,56,59,30,-36,4,21,17,26,29,-20,-24,5,26,14,55,-33,9,-59,-5,38,-4,20,-47,-22,-16,-17,11,10,53,64,34,-2,42,-18,21,-28,-15,-28,47,-24,-25,14,52,-16,39,25,19,-49,-12,-8,-1,-8,-7,-7,-10,42,12,27,11,-22,-8,22,5,0,-8,20,17,-38,29,62,2,-18,7,-28,10,10,-10,-37,52,24,36,-4,-5,3,42,-34,-20,6,-20,25,-8,9,10,5,1,-15,16,15,-33,-15,-61,12,-12,-6,35,28,-35,1,9,-27,-22,28,-22,-3,50,-9,-16,-43,1,20,26,-22,3,24,24,-13,33,29,57,8,-16,32,9,-32,32,3,15,-18,1,2,15,-37,5,-5,0,-21,-33,17,22,-10,-15,9,10,-23,24,19,-44,2,32,6,28,-9,33,-27,24,5,-21,17,27,-30,2,-22,11,-17,-51,12,-68,-10,-23,28,17,51,5,22,30,-13,-6,-17,-55,7,21,11,9,-11,-64,22,12,4,-27,-13,22,10,-53,-53,-1,37,-23,52,-8,-26,-23,8,25,-26,37,20,-22,-17,-67,20,3,27,-28,-18,-19,-11,-33,19,51,-19,9,2,-20,32,33,8,27,21,-25,26,0,19,23,-7,-17,7,21,5,-7,1,-13,58,-33,-32,-9,-14,13,29,12,5,43,71,84,3,67,22,11,41,-49,10,-48,-97,-97,-34,-67,-94,-44,-7,-3,-3,11,-14,1,-6,16,13,-12,47,-32,58,25,16,-2,22,27,-28,-20,-4,20,32,1,-22,-23,11,-25,28,0,-9,36,-26,26,-23,-24,5,4,-21,-12,-32,-29,5,-23,-33,-39,-9,-7,-30,-37,5,15,-12,-1,27,-30,-5,10,11,19,-19,-22,-6,1,-25,41,-68,25,31,35,-5,9,-26,33,35,29,7,-25,38,15,6,-35,12,-3,-3,11,-17,-6,-42,41,42,28,17,-33,-10,18,-27,-29,-49,9,34,-2,6,8,-14,2,-15,-8,9,-17,45,9,7,-18,-12,-23,11,-13,24,18,-6,0,25,50,1,-31,8,8,-12,-33,21,10,-20,-24,-18,-61,2,22,-2,12,6,30,-1,7,16,25,12,27,13,25,-6,-28,-23,-25,-18,9,52,2,30,7,-45,-19,-15,-1,14,-37,-57,51,14,29,39,14,33,-33,-6,12,-25,15,21,-15,16,8,-23,-13,-25,19,31,-9,-2,3,-1,33,53,10,-17,10,-4,4,-2,-14,-12,6,39,2,5,1,-9,-19,-20,-12,-44,5,-10,-25,-8,17,16,-6,-31,-23,-18,1,-6,4,-54,3,-1,24,-7,24,-37,-49,5,-30,-13,37,21,-34,46,52,5,-30,16,11,-34,53,2,-39,17,21,13,45,-31,32,20,10,-22,-3,13,28,-26,-23,-3,18,-28,-9,64,12,-11,-10,45,34,-24,29,12,-12,-8,-32,-6,-26,9,-13,9,1,-39,25,44,49,-12,10,-8,2,32,43,-21,-11,-53,13,-3,-35,0,2,-23,70,-6,18,10,-4,12,-11,-22,67,5,-15,18,-41,-17,-27,-15,-3,-8,61,-10,-41,-43,-33,26,39,5,5,38,-38,2,21,17,-46,-4,15,30,5,17,18,-39,13,-27,-10,25,-22,-5,-31,53,-24,19,69,-21,-34,-7,-1,-3,-2,-2,-21,-8,-22,6,-8,-18,2,-32,15,3,24,-24,-17,3,13,14,-23,-56,-6,14,-8,-18,-2,-41,11,-22,24,-21,1,7,39,-37,2,-28,21,-9,-31,31,34,-8,-32,-13,38,-32,49,3,-36,14,-4,43,-31,-43,-18,22,-24,-9,-4,-44,-38,7,17,-3,-28,7,40,28,-7,-38,91,42,-24,38,-21,-4,-19,34,-7,32,10,12,-10,7,35,-5,-48,-11,-15,-68,48,-32,-45,6,-7,-5,-20,21,-9,-5,36,5,28,3,5,-12,1,34,27,14,47,28,31,37,1,-6,0,14,-26,-8,-4,11,0,-47,6,-8,5,4,-2,-4,-2,3,-45,8,7,-2,47,-17,21,-38,-39,8,11,59,33,-24,6,17,5,-9,-24,-18,13,-15,0,-16,-26,-19,45,20,1,8,-3,9,9,18,32,13,-14,-36,1,-52,-12,-31,11,-11,-16,-42,-57,-4,26,28,-2,-24,-10,1,-29,-18,26,15,-14,-13,-28,-14,15,-44,-5,32,-3,-12,17,40,-32,33,-50,-46,29,-18,32,-34,-4,40,10,14,3,6,-1,-36,-3,0,42,5,-19,24,12,-59,-43,36,55,3,-39,-26,12,-40,4,21,-10,66,21,34,14,-20,-29,3,35,4,7,35,44,5,17,-16,-31,26,-5,4,-19,-22,29,-30,-29,30,-13,-4,39,-6,-1,-20,-58,27,37,-33,-43,13,-20,-19,-55,15,-19,19,-27,7,31,-68,5,-16,39,-10,6,23,1,6,17,-16,23,16,30,-1,-15,6,0,20,18,-22,20,-17,1,19,24,72,19,-41,-23,12,7,21,36,1,14,-1,-19,24,-7,-4,-15,-3,2,-17,-18,-13,19,-17,7,-10,6,13,9,1,-20,46,36,-20,3,14,-37,-5,17,-27,-27,27,-19,-7,52,48,-21,42,-17,-60,-5,-8,-15,10,-27,-44,41,40,15,19,12,39,40,-31,-15,8,52,-21,90,-10,-10,-32,5,34,17,20,-27,-31,0,-3,-7,17,-6,41,4,-11,17,15,4,0,7,45,4,10,6,-24,17,-14,-25,18,-1,2,-47,-6,4,-2,11,60,38,-1,-9,27,7,-13,-3,-20,-27,21,11,31,-21,2,-8,10,3,-11,54,-4,28,12,-41,13,-3,30,24,2,-42,26,22,26,-18,1,36,10,5,-6,-13,45,9,-30,0,-12,-20,-82,6,5,13,-12,-42,11,-16,27,7,-9,49,28,-13,22,-34,59,-34,23,-9,-22,23,28,-19,-16,4,-13,19,-67,4,6,-37,9,-6,-1,-1,-15,37,-51,-17,-60,27,-26,27,12,54,6,-4,-11,28,-35,9,45,-19,2,2,-22,-20,6,-18,-13,-10,-10,13,-6,36,18,-20,2,6,55,-9,36,20,32,0,-5,-25,12,-19,-1,7,11,-54,-46,48,-46,19,-50,-17,-2,-22,-42,18,-28,-20,0,-12,14,-7,28,-48,-2,-15,-29,33,1,-14,-3,55,-14,-36,37,-13,16,24,8,27,-15,33,-52,44,-37,-63,7,5,-27,-18,33,25,22,-22,-11,31,-5,-13,-2,25,-33,-31,15,23,4,21,-15,19,-43,29,45,0,17,9,16,13,-16,13,12,-18,-24,-1,13,-6,-5,16,24,23,-26,-38,-14,12,-9,7,22,11,6,19,-26,25,24,49,6,13,-28,24,-9,25,3,-2,15,3,34,40,32,-14,-11,-8,22,14,8,-53,-42,0,-17,20,1,51,13,-27,-10,-9,13,6,-24,-5,-8,22,8,-16,3,9,-36,-7,16,5,16,26,-6,13,2,-21,-31,1,39,-38,-3,6,-52,23,-8,6,14,-16,42,13,31,12,-9,-21,-34,4,4,14,25,19,38,-44,12,28,15,-5,-34,18,-29,-11,-10,-31,4,25,28,4,54,19,13,-7,7,-31,25,21,-9,-48,-22,6,-16,-41,-39,19,25,13,6,-7,-24,-21,0,8,11,-3,9,43,21,35,38,-17,61,24,-5,3,-4,33,24,12,-22,37,41,40,-25,49,18,2,10,20,-36,21,4,26,12,-4,14,-1,33,-59,-26,-9,-4,3,34,21,-25,2,21,-21,-23,47,62,-27,24,23,-31,-9,-1,1,-21,-16,26,2,-7,-31,22,-15,-61,-39,-26,-15,-16,15,9,-1,-35,58,20,8,-29,-14,24,35,-17,-14,22,22,3,14,4,1,-2,13,-3,-1,4,-11,-33,-34,8,0,17,-29,12,-22,1,-2,14,19,30,62,26,8,7,19,-38,-23,-57,13,-33,-9,-4,53,-40,0,20,1,35,9,13,-32,-26,12,13,-55,22,-40,-28,19,15,-29,11,36,63,-59,-2,-16,17,-28,38,-1,17,52,-38,6,-2,26,-23,-9,30,17,30,3,10,33,-11,7,14,-10,-33,-9,5,11,-10,37,-6,52,18,18,-4,-27,26,30,-37,23,-20,57,7,15,-83,-4,0,-40,-9,3,17,26,-12,-15,14,12,4,-12,32,10,16,17,30,14,2,3,-12,4,7,8,28,73,11,-32,-5,0,-28,-58,14,0,-17,-30,12,33,-11,6,57,-5,43,17,-15,-1,29,33,-26,-35,-32,-54,0,20,31,-15,-24,8,1,22,11,34,14,-9,-9,-22,29,24,8,-15,-64,-1,29,30,24,-26,19,29,-9,-10,-22,-3,-2,14,7,-25,-44,-35,-28,23,-29,9,10,-26,2,11,-3,-5,-3,15,32,24,49,-28,6,-17,-67,11,12,-13,-23,-28,34,8,11,13,-2,-17,-16,-8,-41,22,62,13,5,7,-16,-11,11,-30,-11,-28,41,15,-19,13,6,-32,-12,12,-31,-3,-38,19,4,-39,-10,-12,15,14,-3,9,-19,-12,18,18,45,-17,4,-15,-43,-24,-36,-19,51,29,9,13,-42,17,-24,40,20,-7,42,12,27,0,-31,-21,-13,10,-53,-1,39,8,-9,14,-4,-27,1,0,17,-6,-17,-29,-18,28,36,28,-59,-4,12,-7,-25,-40,15,0,-7,-17,45,-25,30,-6,-20,38,4,-1,-49,11,1,-14,-24,18,19,-29,16,0,-11,21,-12,11,-12,-6,-29,9,7,6,-6,-6,-19,36,2,13,-18,26,-37,10,4,44,-4,-16,-58,-37,68,-45,-25,22,-13,-28,22,-16,-46,-21,-6,-45,28,0,-15,-21,-5,29,-31,19,14,-30,-3,-31,14,8,-1,-62,9,7,9,15,-5,-11,-15,-22,-19,-34,-58,14,-53,4,-20,-4,56,1,5,0,38,-42,75,48,-19,22,-1,-18,-1,21,29,6,20,15,-21,-9,-23,-6,14,40,47,23,-24,-8,-14,-7,18,-19,16,29,3,-2,-6,-22,-17,-12,-19,49,-33,-51,-28,-13,13,3,-10,43,11,-33,-4,40,5,-28,3,-15,-16,4,-16,51,28,13,27,-3,24,9,13,-56,10,3,33,7,1,0,7,-22,-16,-19,19,3,-23,-17,-26,20,-17,2,17,-9,-25,-5,37,30,12,22,44,19,0,12,-44,-25,-50,12,49,-13,37,9,21,16,-33,-38,6,-43,20,9,-24,33,-17,55,22,-48,-33,-8,-3,12,4,-54,-6,21,18,20,56,21,-7,52,-2,-2,-9,-13,-3,-18,-33,12,32,27,22,-60,-21,60,-36,27,-19,-8,-10,54,4,15,18,33,22,16,12,-2,-3,32,-58,34,29,1,62,-5,-6,-20,31,1,3,4,-6,-19,2,25,2,-47,-3,-31,-5,-16,-30,-9,30,17,10,7,40,63,-20,-52,-5,9,-21,29,23,-19,0,30,-15,-21,-8,49,-33,-8,-4,8,12,40,-1,-10,15,35,-15,17,5,-9,-9,20,32,65,16,20,-15,-15,-25,-1,39,-12,-6,2,0,-2,71,-17,6,3,-6,-16,48,-4,42,15,0,51,-1,-31,4,21,-25,-10,-6,-18,-9,-10,18,55,-41,-41,29,-39,-1,12,-14,-18,9,-12,21,-9,-1,50,-60,2,-34,18,19,-30,-23,22,-17,28,-35,-14,-21,41,10,16,3,6,0,6,-20,0,25,-13,-23,-18,14,-4,22,26,21,-29,-33,20,-8,-2,-15,18,-17,-23,-4,-10,43,11,29,-25,16,-11,18,-16,-20,-50,3,-9,-7,-42,-6,52,-23,-7,33,57,-42,-30,-4,-10,-32,22,-10,30,-36,2,-48,16,32,1,50,55,-30,43,25,4,-8,-57,-30,-2,5,-27,19,-19,18,19,-7,-4,-69,-14,16,-9,-12,16,-28,-25};

int main()
{
  display_clear();

  beginReceiver(buffer,BUFFER_RECEIVER_LEN);
  concloverSetValues(signal);

  sendIt("AT+HELP\r\n");
  char received[MAX_RECEIVED_MESSAGE_LEN];
  display_set_lightness(7);

  display_printf("load\n");
  display_put_dot(1);

  int len = 5000;

  set_timer(1, 0);
  conclove(in,in,len);
  int time = get_time(1);

  alt_printf("Time: %x \n",time);


  int nmax = 0;
  unsigned char maxval = 0;
  unsigned long sum = 0;

  for(int n=0;n<len;n++){
	  sum += in[n];

	  if(maxval < in[n]){
		  nmax = n;
		  maxval = in[n];
	  }
  }
  sum = sum / len;

  alt_printf("Avg %x \n",sum);
  alt_printf("Maximum in: %x (%x) \n",nmax,maxval);

  int wsp = maxval/sum;

  alt_printf("Wsp : %x \n",wsp);

  int number = 1;
  while(1){
	  display_clear();
	  display_put_number(number);

	  if(is_pressed(KEYS_KEY1)){
		  alt_printf("PRESS \n");
		  number ++;
	  }

  }

  return 0;
}
